function density = get_DensityOfWaterAtTemperature(temperature_C)
%% Get density of water in kg/m^3 at certain temperature in degrees Celsius
%
%     density = get_DensityOfWaterAtTemperature(temperature_C)
%
% INPUT:
%
%   temperature_C
%       Temperature of water in degrees Celsius.
%
%
% OUTPUT:
%
%   density
%       Density of pure, air-free water H2O at the given temperature under
%       isobaric conditions at normal pressure (1013.25 mbar) in kg/m^3. See:
%       https://www.internetchemistry.com/chemical-data/water-density-table.php
%
%
% ------------------------------------------------------------------------------
% (C) Copyright 2025 Pure Devices GmbH, Wuerzburg, Germany
% www.pure-devices.com
% ------------------------------------------------------------------------------


% figure(1); T = 0:0.1:99.9; plot(T, get_DensityOfWaterAtTemperature(T));

% temperature range
T = 0:0.1:99.9;

% water density in g/ml
% https://www.internetchemistry.com/chemical-data/water-density-table.php
density_water = [...
0.999843, 0.999850, 0.999856, 0.999863, 0.999869, 0.999875, 0.999880, 0.999886, 0.999892, 0.999897, ...
0.999902, 0.999907, 0.999911, 0.999916, 0.999920, 0.999925, 0.999929, 0.999932, 0.999936, 0.999940, ...
0.999943, 0.999946, 0.999949, 0.999952, 0.999955, 0.999957, 0.999960, 0.999962, 0.999964, 0.999965, ...
0.999967, 0.999969, 0.999970, 0.999971, 0.999972, 0.999973, 0.999974, 0.999974, 0.999975, 0.999975, ...
0.999975, 0.999975, 0.999974, 0.999974, 0.999973, 0.999973, 0.999972, 0.999971, 0.999970, 0.999968, ...
0.999967, 0.999965, 0.999963, 0.999961, 0.999959, 0.999957, 0.999954, 0.999952, 0.999949, 0.999946, ...
0.999943, 0.999940, 0.999936, 0.999933, 0.999929, 0.999925, 0.999922, 0.999917, 0.999913, 0.999909, ...
0.999904, 0.999900, 0.999895, 0.999890, 0.999885, 0.999879, 0.999874, 0.999868, 0.999863, 0.999857, ...
0.999851, 0.999845, 0.999839, 0.999832, 0.999826, 0.999819, 0.999812, 0.999805, 0.999798, 0.999791, ...
0.999784, 0.999776, 0.999768, 0.999761, 0.999753, 0.999745, 0.999737, 0.999728, 0.999720, 0.999711, ...
0.999702, 0.999694, 0.999685, 0.999675, 0.999666, 0.999657, 0.999647, 0.999638, 0.999628, 0.999618, ...
0.999608, 0.999598, 0.999587, 0.999577, 0.999566, 0.999556, 0.999545, 0.999534, 0.999523, 0.999512, ...
0.999500, 0.999489, 0.999477, 0.999466, 0.999454, 0.999442, 0.999430, 0.999417, 0.999405, 0.999393, ...
0.999380, 0.999367, 0.999355, 0.999342, 0.999328, 0.999315, 0.999302, 0.999288, 0.999275, 0.999261, ...
0.999247, 0.999233, 0.999219, 0.999205, 0.999191, 0.999176, 0.999162, 0.999147, 0.999133, 0.999118, ...
0.999103, 0.999087, 0.999072, 0.999057, 0.999041, 0.999026, 0.999010, 0.998994, 0.998978, 0.998962, ...
0.998946, 0.998930, 0.998913, 0.998897, 0.998880, 0.998863, 0.998847, 0.998830, 0.998813, 0.998795, ...
0.998778, 0.998761, 0.998743, 0.998725, 0.998708, 0.998690, 0.998672, 0.998654, 0.998635, 0.998617, ...
0.998599, 0.998580, 0.998561, 0.998543, 0.998524, 0.998505, 0.998486, 0.998467, 0.998447, 0.998428, ...
0.998408, 0.998389, 0.998369, 0.998349, 0.998329, 0.998309, 0.998289, 0.998269, 0.998248, 0.998228, ...
0.998207, 0.998186, 0.998166, 0.998145, 0.998124, 0.998103, 0.998081, 0.998060, 0.998039, 0.998017, ...
0.997995, 0.997974, 0.997952, 0.997930, 0.997908, 0.997886, 0.997864, 0.997841, 0.997819, 0.997796, ...
0.997773, 0.997751, 0.997728, 0.997705, 0.997682, 0.997659, 0.997635, 0.997612, 0.997589, 0.997565, ...
0.997541, 0.997518, 0.997494, 0.997470, 0.997446, 0.997422, 0.997397, 0.997373, 0.997349, 0.997324, ...
0.997299, 0.997275, 0.997250, 0.997225, 0.997200, 0.997175, 0.997149, 0.997124, 0.997099, 0.997073, ...
0.997048, 0.997022, 0.996996, 0.996970, 0.996944, 0.996918, 0.996892, 0.996866, 0.996839, 0.996813, ...
0.996786, 0.996760, 0.996733, 0.996706, 0.996679, 0.996652, 0.996625, 0.996598, 0.996571, 0.996543, ...
0.996516, 0.996488, 0.996461, 0.996433, 0.996405, 0.996377, 0.996349, 0.996321, 0.996293, 0.996264, ...
0.996236, 0.996207, 0.996179, 0.996150, 0.996121, 0.996093, 0.996064, 0.996035, 0.996006, 0.995976, ...
0.995947, 0.995918, 0.995888, 0.995859, 0.995829, 0.995799, 0.995770, 0.995740, 0.995710, 0.995680, ...
0.995650, 0.995620, 0.995590, 0.995560, 0.995530, 0.995500, 0.995470, 0.995440, 0.995410, 0.995370, ...
0.995340, 0.995310, 0.995280, 0.995250, 0.995220, 0.995190, 0.995160, 0.995120, 0.995090, 0.995060, ...
0.995030, 0.995000, 0.994960, 0.994930, 0.994900, 0.994870, 0.994840, 0.994800, 0.994770, 0.994740, ...
0.994700, 0.994670, 0.994640, 0.994610, 0.994570, 0.994540, 0.994510, 0.994470, 0.994440, 0.994410, ...
0.994370, 0.994340, 0.994310, 0.994270, 0.994240, 0.994200, 0.994170, 0.994140, 0.994100, 0.994070, ...
0.994030, 0.994000, 0.993960, 0.993930, 0.993900, 0.993860, 0.993830, 0.993790, 0.993760, 0.993720, ...
0.993690, 0.993650, 0.993610, 0.993580, 0.993540, 0.993510, 0.993470, 0.993440, 0.993400, 0.993370, ...
0.993330, 0.993290, 0.993260, 0.993220, 0.993190, 0.993150, 0.993110, 0.993080, 0.993040, 0.993000, ...
0.992970, 0.992930, 0.992890, 0.992860, 0.992820, 0.992780, 0.992740, 0.992710, 0.992670, 0.992630, ...
0.992600, 0.992560, 0.992520, 0.992480, 0.992440, 0.992410, 0.992370, 0.992330, 0.992290, 0.992250, ...
0.992220, 0.992180, 0.992140, 0.992100, 0.992060, 0.992020, 0.991990, 0.991950, 0.991910, 0.991870, ...
0.991830, 0.991790, 0.991750, 0.991710, 0.991670, 0.991630, 0.991590, 0.991560, 0.991520, 0.991480, ...
0.991440, 0.991400, 0.991360, 0.991320, 0.991280, 0.991240, 0.991200, 0.991160, 0.991120, 0.991080, ...
0.991040, 0.991000, 0.990950, 0.990910, 0.990870, 0.990830, 0.990790, 0.990750, 0.990710, 0.990670, ...
0.990630, 0.990590, 0.990550, 0.990500, 0.990460, 0.990420, 0.990380, 0.990340, 0.990300, 0.990250, ...
0.990210, 0.990170, 0.990130, 0.990090, 0.990040, 0.990000, 0.989960, 0.989920, 0.989880, 0.989830, ...
0.989790, 0.989750, 0.989710, 0.989660, 0.989620, 0.989580, 0.989530, 0.989490, 0.989450, 0.989410, ...
0.989360, 0.989320, 0.989280, 0.989230, 0.989190, 0.989150, 0.989100, 0.989060, 0.989010, 0.988970, ...
0.988930, 0.988880, 0.988840, 0.988790, 0.988750, 0.988710, 0.988660, 0.988620, 0.988570, 0.988530, ...
0.988480, 0.988440, 0.988390, 0.988350, 0.988310, 0.988260, 0.988220, 0.988170, 0.988130, 0.988080, ...
0.988040, 0.987990, 0.987940, 0.987900, 0.987850, 0.987810, 0.987760, 0.987720, 0.987670, 0.987630, ...
0.987580, 0.987530, 0.987490, 0.987440, 0.987400, 0.987350, 0.987300, 0.987260, 0.987210, 0.987160, ...
0.987120, 0.987070, 0.987020, 0.986980, 0.986930, 0.986880, 0.986840, 0.986790, 0.986740, 0.986700, ...
0.986650, 0.986600, 0.986550, 0.986510, 0.986460, 0.986410, 0.986360, 0.986320, 0.986270, 0.986220, ...
0.986170, 0.986130, 0.986080, 0.986030, 0.985980, 0.985930, 0.985890, 0.985840, 0.985790, 0.985740, ...
0.985690, 0.985640, 0.985600, 0.985550, 0.985500, 0.985450, 0.985400, 0.985350, 0.985300, 0.985250, ...
0.985210, 0.985160, 0.985110, 0.985060, 0.985010, 0.984960, 0.984910, 0.984860, 0.984810, 0.984760, ...
0.984710, 0.984660, 0.984610, 0.984560, 0.984510, 0.984460, 0.984410, 0.984360, 0.984310, 0.984260, ...
0.984210, 0.984160, 0.984110, 0.984060, 0.984010, 0.983960, 0.983910, 0.983860, 0.983810, 0.983760, ...
0.983710, 0.983660, 0.983610, 0.983550, 0.983500, 0.983450, 0.983400, 0.983350, 0.983300, 0.983250, ...
0.983200, 0.983140, 0.983090, 0.983040, 0.982990, 0.982940, 0.982890, 0.982830, 0.982780, 0.982730, ...
0.982680, 0.982630, 0.982570, 0.982520, 0.982470, 0.982420, 0.982370, 0.982310, 0.982260, 0.982210, ...
0.982160, 0.982100, 0.982050, 0.982000, 0.981940, 0.981890, 0.981840, 0.981790, 0.981730, 0.981680, ...
0.981630, 0.981570, 0.981520, 0.981470, 0.981410, 0.981360, 0.981310, 0.981250, 0.981200, 0.981150, ...
0.981090, 0.981040, 0.980980, 0.980930, 0.980880, 0.980820, 0.980770, 0.980710, 0.980660, 0.980610, ...
0.980550, 0.980500, 0.980440, 0.980390, 0.980330, 0.980280, 0.980220, 0.980170, 0.980110, 0.980060, ...
0.980000, 0.979950, 0.979890, 0.979840, 0.979780, 0.979730, 0.979670, 0.979620, 0.979560, 0.979510, ...
0.979450, 0.979400, 0.979340, 0.979290, 0.979230, 0.979180, 0.979120, 0.979060, 0.979010, 0.978950, ...
0.978900, 0.978840, 0.978780, 0.978730, 0.978670, 0.978610, 0.978560, 0.978500, 0.978450, 0.978390, ...
0.978330, 0.978280, 0.978220, 0.978160, 0.978110, 0.978050, 0.977990, 0.977940, 0.977880, 0.977820, ...
0.977760, 0.977710, 0.977650, 0.977590, 0.977540, 0.977480, 0.977420, 0.977360, 0.977310, 0.977250, ...
0.977190, 0.977130, 0.977080, 0.977020, 0.976960, 0.976900, 0.976840, 0.976790, 0.976730, 0.976670, ...
0.976610, 0.976550, 0.976500, 0.976440, 0.976380, 0.976320, 0.976260, 0.976200, 0.976140, 0.976090, ...
0.976030, 0.975970, 0.975910, 0.975850, 0.975790, 0.975730, 0.975670, 0.975620, 0.975560, 0.975500, ...
0.975440, 0.975380, 0.975320, 0.975260, 0.975200, 0.975140, 0.975080, 0.975020, 0.974960, 0.974900, ...
0.974840, 0.974780, 0.974720, 0.974660, 0.974600, 0.974540, 0.974480, 0.974420, 0.974360, 0.974300, ...
0.974240, 0.974180, 0.974120, 0.974060, 0.974000, 0.973940, 0.973880, 0.973820, 0.973760, 0.973700, ...
0.973640, 0.973580, 0.973520, 0.973450, 0.973390, 0.973330, 0.973270, 0.973210, 0.973150, 0.973090, ...
0.973030, 0.972970, 0.972900, 0.972840, 0.972780, 0.972720, 0.972660, 0.972600, 0.972530, 0.972470, ...
0.972410, 0.972350, 0.972290, 0.972230, 0.972160, 0.972100, 0.972040, 0.971980, 0.971910, 0.971850, ...
0.971790, 0.971730, 0.971670, 0.971600, 0.971540, 0.971480, 0.971420, 0.971350, 0.971290, 0.971230, ...
0.971160, 0.971100, 0.971040, 0.970980, 0.970910, 0.970850, 0.970790, 0.970720, 0.970660, 0.970600, ...
0.970530, 0.970470, 0.970410, 0.970340, 0.970280, 0.970220, 0.970150, 0.970090, 0.970030, 0.969960, ...
0.969900, 0.969830, 0.969770, 0.969710, 0.969640, 0.969580, 0.969510, 0.969450, 0.969390, 0.969320, ...
0.969260, 0.969190, 0.969130, 0.969060, 0.969000, 0.968930, 0.968870, 0.968810, 0.968740, 0.968680, ...
0.968610, 0.968550, 0.968480, 0.968420, 0.968350, 0.968290, 0.968220, 0.968160, 0.968090, 0.968030, ...
0.967960, 0.967900, 0.967830, 0.967760, 0.967700, 0.967630, 0.967570, 0.967500, 0.967440, 0.967370, ...
0.967310, 0.967240, 0.967170, 0.967110, 0.967040, 0.966980, 0.966910, 0.966840, 0.966780, 0.966710, ...
0.966640, 0.966580, 0.966510, 0.966450, 0.966380, 0.966310, 0.966250, 0.966180, 0.966110, 0.966050, ...
0.965980, 0.965910, 0.965850, 0.965780, 0.965710, 0.965650, 0.965580, 0.965510, 0.965440, 0.965380, ...
0.965310, 0.965240, 0.965180, 0.965110, 0.965040, 0.964970, 0.964910, 0.964840, 0.964770, 0.964700, ...
0.964630, 0.964570, 0.964500, 0.964430, 0.964360, 0.964300, 0.964230, 0.964160, 0.964090, 0.964020, ...
0.963960, 0.963890, 0.963820, 0.963750, 0.963680, 0.963610, 0.963550, 0.963480, 0.963410, 0.963340, ...
0.963270, 0.963200, 0.963130, 0.963060, 0.963000, 0.962930, 0.962860, 0.962790, 0.962720, 0.962650, ...
0.962580, 0.962510, 0.962440, 0.962370, 0.962300, 0.962240, 0.962170, 0.962100, 0.962030, 0.961960, ...
0.961890, 0.961820, 0.961750, 0.961680, 0.961610, 0.961540, 0.961470, 0.961400, 0.961330, 0.961260, ...
0.961190, 0.961120, 0.961050, 0.960980, 0.960910, 0.960840, 0.960770, 0.960700, 0.960630, 0.960560, ...
0.960490, 0.960420, 0.960350, 0.960270, 0.960200, 0.960130, 0.960060, 0.959990, 0.959920, 0.959850, ...
0.959780, 0.959710, 0.959640, 0.959570, 0.959490, 0.959420, 0.959350, 0.959280, 0.959210, 0.959140, ...
0.959070, 0.958990, 0.958920, 0.958850, 0.958780, 0.958710, 0.958640, 0.958560, 0.958490, 0.958420];

[p, S, mu] = polyfit(T, density_water, 8);  % 8 is enough
density = polyval(p, temperature_C, S, mu)*1000;
density((temperature_C<0) | (temperature_C>100)) = NaN;  % avoid extrapolation
% density = interp1(t, d, temperature_C, 'linear');  % numeric ripple

end
